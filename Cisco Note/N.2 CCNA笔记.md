# 网络基础

## 开放式系统互联模型(Open System Interconnection Model)[[A1]](#_msocom_1) 

[第七层]应用层(Application Layer)[[A2]](#_msocom_2) 实际上就是应用软件

[第六层]表示层(Presentation Layer)[[A3]](#_msocom_3) 定义数据的格式，基本的压缩和加密的功能

[第五层]会话层(Session Layer)[[A4]](#_msocom_4) 控制的是一个应用程序/IP地址的多个会话

[第四层]传输层(Transport Layer)[[A5]](#_msocom_5) 定义端到端通信，端到端链接的一些基本功能以及如何保证传输的速度、效率、可靠性，最重要的两个协议是TCP和UDP

[第三层]网络层 (Network Layer)[[A6]](#_msocom_6) 最主要的两个功能就是三层的IP编址和定义了路由功能

[第二层]数据链路层(Data Link Layer)[[A7]](#_msocom_7) 定义数据的基本格式，数据如何在线缆上进行传输，怎么进行标识

[第一层]物理层(Physical Layer)[[A8]](#_msocom_8) 实现最基本的底层数据传输，比如说底层的接口、传输的方式

### 数据封装(Data Encapsulation)

数据在传输的过程中会有一个封装的过程

在传输数据时会从上到下进行封装。比如在西安用微信和北京朋友聊天，两地的主机进行通信，要把hello传到目标主机，这时候这个数据会分别经过OSI的七层并加上每一层的标识。

数据在传输是会从第七层开始逐层往下走，加上每一层的数据信息，这个数据信息就是报头，每一层的信息都保存在这一层的报头里，如二层的的报头里就会储存着主机的MAC地址

## 物理层(Physical Layer)[[A9]](#_msocom_9) 

### 双绞线

八根线缆，分为四组，每组两根，两根线绞在一起，加强抗干扰能力

接口是RJ-45，使用的是水晶头,两种线序568A和568B

网络传输使用12 36，分别有两对发和收

电话线45供电78

类型：

UTP双绞线: 屏蔽双绞线 |在一对线外部还有一个金属屏蔽层缺点贵，重，难布线

STP双绞线: 非屏蔽双绞线，一般来说是这种类型

下面笔记待整理

F/UTP双绞线：总屏蔽层为铝箔屏蔽，没有线对屏蔽层的屏蔽双绞线；

U/FTP双绞线：没有总屏蔽层，线对屏蔽为铝箔屏蔽的屏蔽双绞线；

SF/UTP双绞线：总屏蔽层为丝网＋铝箔的双重屏蔽，线对没有屏蔽的双重屏蔽双绞线；

S/FTP双绞线：总屏蔽层为丝网，线对屏蔽为铝箔屏蔽的多重屏蔽双绞线；

U/UTP双绞线：即通常所说的UTP双绞线，非屏蔽双绞线。

### 以太网线分为两种类型

直通线\平行线：两端的线序是相同的(国内一般都是568B)

交叉线：两端的线序是相反的（13 26 对调）

连接不同类型的设备用平行线

连接相同的设备用交叉线

### 光纤(Optical Fiber)

成对连接，两端对调

单模光纤:一般光纤跳纤用黄色表示，接头和保护套为蓝色 传输离较长

多模光纤:一般光纤跳纤用登色表示，也有的用灰色表示，接头和保护套用米色或

者黑色 传输离较短

## 数据链路层(Data Link Layer)
資料連結層（Data Link Layer）负责网络寻址、错误侦测和改错。当表头和表尾被加至数据包时，会形成[信息框](https://zh.wikipedia.org/wiki/%E8%B3%87%E8%A8%8A%E6%A1%86)（Info Box）。数据链表头（DLH）是包含了物理地址和错误侦测及改错的方法。数据链表尾（DLT）是一串指示数据包末端的字符串。例如以太网、无线局域网（Wi-Fi）和通用分组无线服务（GPRS）等。

分为两个子层：逻辑链路控制（logical link control，LLC）子层和介质访问控制（Media access control，MAC）子层。

### 局域网(LAN Local Area Network)

特点是短距离的直接线缆相连的，比较高速的连接

### MAC编址

分为两个部分OUI和VendorAssigned

OUI是组织唯一标识符占22位，用来标识厂商

VendorAssigned就是区别的mac

### 二层报头的格式

Preamble | Destination Address | Source Address | Type | Data | FCS

先导字段 | 目标MAC地址 | 源MAC地址 | 类型 | 用户数据 | 校验

### 以太网的传输数据的三种的方法

单波 一对一的通信

广播 一对所有(局域网内)的通信 MAC地址全为1(全F)

组播 一和部分设备通信

### 以太网避免冲突的方式

CSMA/CD(冲突域)带冲突检测的载波监听访问

是被动的

### 无线局域网(wireless LAN)

### 地址解析协议（Address Resolution Protocol）

## 网络层 (Network Layer)[[A11]](#_msocom_11) 

### IPv4协议

两个部分，网络部分和主机部分

IP协议允许你对不同的数据包进行标记，给不同的包打上标识用的是Qos技术

特点：

层次化，结构化的编址

Ip协议是一个面向非连接的协议

对数据进行了数据包的划分

Ip协议是一个尽力而为的传输协议

没有数据恢复机制

32位(bit)

IPv4协议的报头

Byte1   |    Byte2   |   Byte3  |   Byte4
字节一    |   字节二.  |  字节三  |  字节四
Ver.  IHL  | Service Type |  Packet Length
版本信息  | 服务类型.  |  包长度 最大长度是(65535)
Identification     | flag |     Frag. Offset
分片标识      | 标识 |    分片偏移
Time to Live |     Protocol  l  Header Checksum
存活时间  |     协议         |    报头校验

                 Source Address

源地址(32-bit)

Destination Address

目标地址(32-bit)

→            Options              |            Padding

可选字段(一般不用)         |             填充字段

### 路由功能

不同网段的通信

路由器把数据包在不同网段之间进行转发

路由器是最常用的三层设备

用来隔离广播

路由器永远不转发广播

路由器通过路由表进行转发

路由器可以自己选择最优路径

### 路由表

對每組網络介面（interface），路由表至少會存有下面的信息：

1、网络ID（Network ID, Network number）：就是目标地址的网络ID。

2、子网掩码（subnet mask）：用來判斷IP所屬網络

3、下一跳地址/接口（Next hop / interface）：就是数据在发送到目标地址的旅途中下一站的地址。其中interface指向next hop（即為下一個route）。一個自治系統（AS, Autonomous system）中的route應該包含區域內所有的子網路，而默认网关（Network id: 0.0.0.0, Netmask: 0.0.0.0）指向自治系統的出口。

根据应用和执行的不同，路由表可能含有如下附加信息：

花费（Cost）：就是数据发送过程中通过路径所需要的花费。

路由的服务质量

路由中需要过滤的出/入连接列表

路由表也是一个网络安全的关键，像单播可逆路径传输（uRPF）[3]就是一个安全路由表的例子。在这种具有多种变体的技术中，路由器也在路由表中查找数据包的源地址，如果源地址不正确，数据包就会显示出错或受到攻击。

### MTU(最大传输单元)

这是一个物理限制

一个物理接口最大能够传输1500字节

如果超过了1500就要分片传输，将传输的数据分为一个一个数据包

### 分片标识

在数据进行分割传输后，在拼装数据的时候

### 分片偏移

当前分片的位置距离第一个分片的距离有多远，用来重组数据包

### Time to Live (TTL)存活时间

生存时间( TTL ) 或跳数限制是一种限制计算机或网络中数据的生命周期或生命周期的机制。TTL 可以被实现为附加到或嵌入到数据中的计数器或时间戳。一旦指定的事件计数或时间跨度过去，数据将被丢弃或重新验证。在计算机网络中，TTL 可防止数据包无限循环。在计算应用中，TTL 通常用于提高性能和管理数据

### Protocol协议

用来实现多路复用

### IPv4地址样式

点分十进制，每一部分8位，共四部分

十进制xxx.xxx.xxx.xxx

二进制xxxxxxxx.xxxxxxxx.xxxxxxxx.xxxxxxxx

### IPv4地址分类

固定格式

A     0xxxxxxx.xxxxxxxx.xxxxxxxx.xxxxxxxx    

前8位是网络部分

B     10xxxxxx.xxxxxxxx.xxxxxxxx.xxxxxxxx

前16位是网络部分

C     110xxxxx.xxxxxxxx.xxxxxxxx.xxxxxxxx

前24位是网络部分

D     1110xxxx.xxxxxxxx.xxxxxxxx.xxxxxxxx

E     11110xxx.xxxxxxxx.xxxxxxxx.xxxxxxxx

### IPv4地址A、B、C类

                     第一个八位组（十进制）    第一个八位组（二进制）           可分配主机数

A类地址           1-126                            00000001 to 01111110               16,777,214

环回保留网段       127                                     01111111

B类地址          128-191                          10000000 to 10111111                   65,534

C类地址          129-223                          11000000 to 11011111                        254

### 保留地址

主机部分全为0

用来标识一个网络

主机部分全为1

广播地址

### MPLS笔记

MPLS是多协议标签交换架构

属于2.5层的协议

这是MPLS的帧格式

专有名词

LER：处于MPLS网络的边界设备，负责标签的压入push和弹出pop

LSR：处于MPLS网络的中间区域，负责标签的交换swap

---

 [[A1]](#_msoanchor_1)是一种[概念模型](https://zh.wikipedia.org/wiki/%E6%A6%82%E5%BF%B5%E6%A8%A1%E5%9E%8B)，由[国际标准化组织](https://zh.wikipedia.org/wiki/%E5%9B%BD%E9%99%85%E6%A0%87%E5%87%86%E5%8C%96%E7%BB%84%E7%BB%87)提出，一个试图使各种计算机在世界范围内互连为网络的标准框架。定义于ISO/IEC 7498-1。

该模型将通信系统中的数据流划分为七个层，从分布式应用程序数据的最高层表示到跨通信介质传输数据的物理实现。每个中间层为其上一层提供功能，其自身功能则由其下一层提供。功能的类别通过标准的通信协议在软件中实现。

开放式系统互联模型的开发始于上世纪70年代后期，用以支持各种计算机联网方法的出现。在上世纪80年代，该模型成为国际标准化组织（ISO）开放系统互连小组的工作产品。

 [[A2]](#_msoanchor_2)提供为应用软件而设计的接口，以设置与另一应用软件之间的通信。例如：HTTP、HTTPS、FTP、Telnet、SSH、SMTP、POP3等。

 [[A3]](#_msoanchor_3)把数据转换为能与接收者的系统格式兼容并适合传输的格式。

 [[A4]](#_msoanchor_4)负责在数据传输中设置和维护计算机网络中两台计算机之间的通信连接。

 [[A5]](#_msoanchor_5)把传输表头（TH）加至资料以形成分组。传输表头包含了所使用的协议等发送信息。例如:传输控制协议（TCP）等。

 [[A6]](#_msoanchor_6)决定数据的路径选择和转寄，将网络表头（NH）加至数据包，以形成分组。网络表头包含了网络资料。例如:互联网协议（IP）等

 [[A7]](#_msoanchor_7)資料連結層（Data Link Layer）负责网络寻址、错误侦测和改错。当表头和表尾被加至数据包时，会形成[信息框](https://zh.wikipedia.org/wiki/%E8%B3%87%E8%A8%8A%E6%A1%86)（Info Box）。数据链表头（DLH）是包含了物理地址和错误侦测及改错的方法。数据链表尾（DLT）是一串指示数据包末端的字符串。例如以太网、无线局域网（Wi-Fi）和通用分组无线服务（GPRS）等。

分为两个子层：逻辑链路控制（logical link control，LLC）子层和介质访问控制（Media access control，MAC）子层。

 [[A8]](#_msoanchor_8)在局域网上发送[数据帧](https://zh.wikipedia.org/wiki/%E6%95%B0%E6%8D%AE%E5%B8%A7)（Data Frame），它负责管理电脑通信设备和网络媒体之间的互通。包括了针脚、电压、线缆规范、集线器、中继器、网卡、主机接口卡、路由器等。

 [[A9]](#_msoanchor_9)在局域网上发送[数据帧](https://zh.wikipedia.org/wiki/%E6%95%B0%E6%8D%AE%E5%B8%A7)（Data Frame），它负责管理电脑通信设备和网络媒体之间的互通。包括了针脚、电压、线缆规范、集线器、中继器、网卡、主机接口卡、路由器等。

 [[A10]](#_msoanchor_10)資料連結層（Data Link Layer）负责网络寻址、错误侦测和改错。当表头和表尾被加至数据包时，会形成[信息框](https://zh.wikipedia.org/wiki/%E8%B3%87%E8%A8%8A%E6%A1%86)（Info Box）。数据链表头（DLH）是包含了物理地址和错误侦测及改错的方法。数据链表尾（DLT）是一串指示数据包末端的字符串。例如以太网、无线局域网（Wi-Fi）和通用分组无线服务（GPRS）等。

分为两个子层：逻辑链路控制（logical link control，LLC）子层和介质访问控制（Media access control，MAC）子层。

 [[A11]](#_msoanchor_11)决定数据的路径选择和转寄，将网络表头（NH）加至数据包，以形成分组。网络表头包含了网络资料。例如:互联网协议（IP）等