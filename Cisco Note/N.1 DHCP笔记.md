# 报文格式
+--------------------------------------------------------------------------------------+
| Destination MAC  | Source MAC  |   Type   |                Data               |       FCS       |
| 目标MAC地址       | 源MAC地址   |   类型   |                数据               | 帧校验序列 |
| 6 Bytes                  |    6 Bytes       | 2 Bytes |  46 - 1 500/9000 Bytes |     4 Bytes    |
+--------------------------------------------------------------------------------------+
DHCP是应用层协议，基于UDP 
服务端端口号是67 客户端端口号是68 
# 四步协商过程
客户端 (UDP 68)                     服务器 (UDP 67)
      🖥️  ------------------------------------  🖥️
      
tip.1 Discover报文 {广播}
广播寻找DHCP服务器
tip.2  Offer报文  {广播or单播}  多台服务器收到Discover报文都会回复，看客户端先收到谁的报文就用谁
服务器给客户端返回IP参数
tip.3 Request报文 {广播}
通知选择的服务器，客户端使用此服务器的参数，通知其他服务器我响应了谁的Offer，其他没有被响应的服务器继续待机
tip.4 ACK报文 {广播or单播}
服务器回应收到

# 租约刷新

→                                                             50%                                                 87.5%          100%
--------------------------------------------------↓--------------------------------------↓----------↓
→                                                            Renewal                                     Rebinding         Release
→                                                                                                                                          释放

租约到了50%的时候
tip.1 Request
客户端发送继续使用地址申请
tip.2 ACK
服务器回应=刷新成功
然后租期复位继续从零开始计算
如果刷新失败，则等到87.5%的时候
tip.1 Request
客户端发送继续使用地址申请
tip.2 ACK
服务器回应=刷新成功
然后租期复位继续从零开始计算
如果还是失败，则到100%的时候释放IP
客户端要是还想要获取IP参数，则需要重新四步协商








20250331